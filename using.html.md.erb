---
title: Using PCF Log Search
owner: London Services
---

This topic describes how to use the Kibana front end of PCF Log Search. Kibana is a web application that lets you search logs sent to Log Search, create visualizations of searches, and create dashboards from collections of visualizations.

Log Search receives raw data from your system in JSON format. Log Search parses and timestamps this data, filters it by keys, and adds tags based on information about your system. Once you understand the way that Log Search structures information, you can use Kibana to find and visualize the information you want.


##<a id="kibana"></a>Log in to Kibana

If you have the Elastic Runtime installed, you can follow these steps to open Kibana:

1. Navigate to `https://logsearch.SYSTEM-DOMAIN`. 
1. Log in using the **Router** credentials under the **Credentials** tab in the PCF Log Search tile. 


##<a id="view-and-filter"></a>View and Filter Log Data

Open the **Discover** page to access and understand the metrics generated by your apps and infrastructure. From the Discover page you can view raw log data, data for specific fields, and filtered data.

![The Discover Button](./images/discoverbutton.png)

By default, the Discover page shows the most recently received logs. This view actively updates as you filter by fields, perform searches, and change the time scale.

###<a id="view-raw"></a> View Raw Log Data

Raw JSON files can be large and difficult to navigate, but you can view them by selecting **@raw** under **Available Fields** on the left side of the screen.

###<a id="view-fields"></a> View and Filter by Field

You can filter data based on tags generated by Log Search or any keys within the JSON logs themselves. See the [Data Dictionary and Search Guide](./search-guide.html) topic for more information on the tags generated by Log Search. 

The **Available Fields** list on the left side of the Discover page lists the Log Search tags first, followed by the parsed log keys. Log Search prepends the generated fields with the `@` symbol. 

![The Available Fields](./images/availablefields.png)

Follow these steps to filter by a field and its values in the **Available Fields** list:

1. Click the field in the **Available Fields** list that you want to filter by. A popup appears showing the values you can filter for within that field, with their relative frequencies. In the example below, `@source.deployment` is the selected field. The popup indicates that values for the field include `rabbitmq` and `CF`, and that in two-thirds of the log entries that list `@source_deployment` the field has the value `rabbitmq`.

    ![Filter List](./images/filterlist.png)

1. To filter the search results for one of the field values, for example `rabbitmq`, click the **+** magnifying glass icon. Alternatively, to filter **out** all instances of that value, leaving in all others, click the **-** magnifying glass icon. You can filter in or filter out multiple field values at once.

1. The Search Results page updates immediately based on the current filters.

### <a id="time-scale"></a>Change the Time Scale and Refresh Interval

By default, the time-scale and refresh rate are set to **15 minutes** and **Today**, as you can see when you log on in the top-right hand corner of the Discover page.

![The time-scale and the refresh rate](./images/time-scale.png)

For more information on the these settings and how to change them, see the Kibana user guide, the correct section of which can be found [here](https://www.elastic.co/guide/en/kibana/current/discover.html#set-time-filter).


### <a id="search"></a> Search Log Data

You can further refine your results from any filter or time span using the search bar at the top of the page. see the [Kibana user guide](https://www.elastic.co/guide/en/kibana/current/discover.html#search) for more information on how to search your data.

##<a id="create-a-visualization"></a>Create a Visualization

Follow these steps to visualize the results of any search.

1. Save the search by clicking the save icon to the right of the search bar and entering a name.

	![Save icon](./images/saveicon.png)

1. Click on the **Visualize** tab in the Kibana navigation menu.

	![Visualize tab](./images/visualizetab.png)

1. From the screen that appears, select the type of visualization you would like to create. **Data Table**, **Line Chart**, and **Vertical Bar Chart** are usually the most useful for log data. For more details about the available visualizations, see the [Kibana user guide](https://www.elastic.co/guide/en/kibana/current/visualize.html).

1. When prompted to select a search source, choose **From a Saved Search**.

1. Select the search that you just saved. This displays a graph, that you may want to refine. Follow the procedure below to customize your visualization to make it more useful.

###<a id="customize-a-visualization"></a>Customize a Visualization

This example shows how you can customize a Vertical Bar Chart based on the saved search `hm_agent_heartbeat`.

#### Display Search Results Volume by Date

To create a chart that aggregates `hm_agent_heartbeat` log entries by date:

1. From the left pane, select the **Add Buckets** tab.
1. Select the **X-Axis** bucket type.
1. In the **Aggregation** dropdown, select **Date Histogram**
1. In the Field dropdown, select **@timestamp**
1. Leave the Interval set to **auto**.
1. Click the **Play** icon at top right.

#### Display Search Results Volume by Date and Machine Type

The graph above shows the amount of `hm_agent_heartbeat` log entries over time, but it may be more helpful to also see which types of machines are generating these entries. Follow these steps to split each vertical bar by **@source.deployment** field values:

1. From the left pane, click the **Add Sub-Buckets** tab.
1. Click the **Split Bars** button.
1. From the **Sub Aggregation** dropdown, select **Terms** to reveal more options.
1. From the **Field** dropdown, find and select **@source.deployment**.
1. Click the **Play** icon.

NOTE: if you do not see all of the deployments that you expect, you can increase the size of the displayed data in the **Order** field in the sub-bucket options. The **Size** must be equal to or more than the number of different machines from which you are receiving logs to ensure all the data is displayed.

If you would like, you can save any visualization that you have created using the save icon in the top-right of the visualization screen. Note that saving it required to use the visualization in a dashboard.

##<a id="creating-a-dashboard"></a>Create a Dashboard

A dashboard can be used to display and filter simultaneously many visualizations and saved searches. From the top navigation bar, select the **Dashboard** tab.

![Visualize tab](./images/dashboard.png)

To get started, click the **New Dashboard** button from the top-right icons, as shown below:

![New Icon](./images/newicon.png)

An empty dashboard is created, and the words "Ready to get started?" will be displayed in the centre of the page. Click the **Add to Dashboard** button, which is shown below:

![New Panel](./images/newpanel.png)

The Visualizations and Searches search menu appears. In this example, we're going to add the visualization created in the section above, and then a search that we have saved.

1. From the Visualization filter, type "HM Agent Heartbeats", and select the visualization that appears.
1. Click the **Searches** tab, and enter a saved search. In this case, we have entered **ValueMetrics**.
1. These two metrics will be added to your dashboard.

    One advantage that a dashboard provides is allowing filters to affect all the displayed panes. For instance, using the time filter in the top-right will apply your time changes to every displayed visualization and search. Clicking on a bar in a visualization will filter all the panels by that metric.

1. Each visualization and search can also be resized and repositioned via clicking and dragging their title bar and using the arrow in the lower-right corner.

    ![Finished Dashboard](./images/finisheddashboard.png)

1. Any created dashboards can be saved using the save button in the top-right hand side of the dashboard page.

    ![Save Icon](./images/saveicon.png)

More information on creating a dashboard can be found [here](https://www.elastic.co/guide/en/kibana/current/dashboard.html).
